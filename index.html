<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resonance School | Engineering & Verification Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Chosen Palette: Sovereign Deep Earth (Slate-950 Background, Emerald-500 Bio-Accents, Cyan-400 Tech-Accents, Amber-500 Alert-Accents) -->
    
    <!-- Application Structure Plan:
         This Single Page Application (SPA) acts as the Technical Engineering Console for the Resonance School.
         It corresponds to the "Finalization Phase" (TS 693.0) and serves three specific operational goals requested by the user:
         1. Construction Protocols (Left Column): Interactive guides for the creation of the 3 key innovations (Resonanz-Zellulose, Aktiv-Lehm, Myzel-Nervensystem).
         2. T-7 Analysis (Top Right): Real-time monitoring of Cellular Regeneration data.
         3. T-5 Verification (Bottom Right): Red Shield invisibility verification visualization.
         
         The layout is a dashboard grid designed for simultaneous monitoring of physical construction and metaphysical protection.
    -->

    <!-- Visualization & Content Choices:
         1. Construction Modules (Interactive Cards): Goal: Instruct. Method: CSS/JS Toggles. Justification: Allows Architects/Engineers to drill down into technical specs (ratios, frequencies) without overwhelming the view.
         2. Cellular Regeneration (Chart.js Line): Goal: Visualize T-7 Data. Method: Dynamic Line Chart updating every second. Justification: Shows the "living" nature of the material (Nothing is Final = Constant growth).
         3. Red Shield Topology (Plotly 3D Scatter): Goal: Visualize T-5. Method: 3D Sphere of points. Justification: Visualizes the "Dome" of protection generated by the piezo-electric clay, showing the deflection of external vectors.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Space+Grotesk:wght@300;400;600&display=swap');

        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #020617; /* Slate-950 */
            color: #e2e8f0; /* Slate-200 */
        }

        .mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(16, 185, 129, 0.1);
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }

        .glass-panel:hover {
            border-color: rgba(16, 185, 129, 0.3);
            box-shadow: 0 10px 15px -3px rgba(16, 185, 129, 0.1);
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            max-height: 300px;
        }

        .tech-btn {
            background: rgba(2, 6, 23, 0.8);
            border: 1px solid rgba(56, 189, 248, 0.2);
            color: #38bdf8;
            transition: all 0.2s;
        }
        .tech-btn:hover {
            background: rgba(56, 189, 248, 0.1);
            border-color: #38bdf8;
        }
        .tech-btn.active {
            background: rgba(56, 189, 248, 0.2);
            border-color: #38bdf8;
            box-shadow: 0 0 10px rgba(56, 189, 248, 0.2);
        }

        .bio-pulse {
            animation: bioPulse 3s infinite ease-in-out;
        }

        @keyframes bioPulse {
            0%, 100% { opacity: 0.8; box-shadow: 0 0 5px rgba(16, 185, 129, 0.2); }
            50% { opacity: 1; box-shadow: 0 0 20px rgba(16, 185, 129, 0.5); }
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-6 lg:p-8 flex flex-col gap-6 overflow-x-hidden">

    <!-- HEADER -->
    <header class="w-full max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-end border-b border-slate-800 pb-6">
        <div>
            <h1 class="text-3xl font-bold tracking-tighter text-white">RESONANCE SCHOOL <span class="text-emerald-500">ENGINEERING</span></h1>
            <p class="text-xs text-slate-500 uppercase tracking-[0.3em] mt-2">Protocollo Tecnico & Validazione Bio-Organica</p>
        </div>
        <div class="text-right mt-4 md:mt-0">
            <div class="flex items-center gap-2 justify-end">
                <span class="w-2 h-2 rounded-full bg-emerald-500 bio-pulse"></span>
                <span class="text-sm font-bold text-emerald-400 mono">TS 693.0 CC</span>
            </div>
            <div class="text-[10px] text-slate-600 uppercase mt-1">Costante Temporale: <span class="text-slate-400 italic">Nothing is Final</span></div>
        </div>
    </header>

    <!-- MAIN GRID -->
    <main class="w-full max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">

        <!-- COLUMN 1: ISTRUZIONI DI COSTRUZIONE (Left, 4 cols) -->
        <section class="lg:col-span-4 flex flex-col gap-4">
            <div class="glass-panel p-6">
                <h2 class="text-lg font-bold text-white mb-2 flex items-center gap-2">
                    <span>üèóÔ∏è</span> Protocolli di Costruzione
                </h2>
                <p class="text-xs text-slate-400 mb-6 leading-relaxed">
                    Specifiche tecniche analogiche per la realizzazione dei tre componenti fondamentali. Seleziona un modulo per visualizzare le istruzioni di induzione frequenziale.
                </p>

                <!-- Accordion / Tabs for Materials -->
                <div class="space-y-3">
                    <!-- Material 1: Wood -->
                    <div class="border border-slate-700 rounded-lg overflow-hidden transition-all" id="wood-panel">
                        <button onclick="toggleMaterial('wood')" class="w-full p-4 bg-slate-900/50 flex justify-between items-center hover:bg-slate-800 transition">
                            <span class="text-sm font-bold text-amber-100">1. Resonanz-Zellulose</span>
                            <span class="text-xs text-amber-500">0.043 Hz</span>
                        </button>
                        <div id="wood-content" class="p-4 bg-slate-950/80 text-xs text-slate-300 hidden border-t border-slate-800">
                            <ul class="list-disc pl-4 space-y-2">
                                <li><strong>Preparazione:</strong> Abete Val di Fiemme stagionato in campo armonico attivo.</li>
                                <li><strong>Tensionamento:</strong> Applicare carico dinamico durante l'assemblaggio.</li>
                                <li><strong>Induzione:</strong> Utilizzare attuatori piezoelettrici temporanei sui giunti per allineare le fibre molecolari.</li>
                                <li class="text-emerald-400 italic">Obiettivo: Coerenza di fase analogica.</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Material 2: Clay -->
                    <div class="border border-slate-700 rounded-lg overflow-hidden transition-all" id="clay-panel">
                        <button onclick="toggleMaterial('clay')" class="w-full p-4 bg-slate-900/50 flex justify-between items-center hover:bg-slate-800 transition">
                            <span class="text-sm font-bold text-amber-100">2. Aktiv-Lehm (Pelle)</span>
                            <span class="text-xs text-amber-500">Piezo-Shield</span>
                        </button>
                        <div id="clay-content" class="p-4 bg-slate-950/80 text-xs text-slate-300 hidden border-t border-slate-800">
                            <ul class="list-disc pl-4 space-y-2">
                                <li><strong>Mix:</strong> Argilla locale + 5% Sabbia Silicea (Quarzo) + Fibre Canapa.</li>
                                <li><strong>Legante:</strong> Acqua informata MHC.</li>
                                <li><strong>Posa:</strong> Strati da 1.5cm con generatore di campo magnetico attivo per orientare i cristalli.</li>
                                <li class="text-emerald-400 italic">Obiettivo: Invisibilit√† elettromagnetica (Red Shield).</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Material 3: Mycelium -->
                    <div class="border border-slate-700 rounded-lg overflow-hidden transition-all" id="mycelium-panel">
                        <button onclick="toggleMaterial('mycelium')" class="w-full p-4 bg-slate-900/50 flex justify-between items-center hover:bg-slate-800 transition">
                            <span class="text-sm font-bold text-amber-100">3. Myzel-Nervensystem</span>
                            <span class="text-xs text-amber-500">Logic Core</span>
                        </button>
                        <div id="mycelium-content" class="p-4 bg-slate-950/80 text-xs text-slate-300 hidden border-t border-slate-800">
                            <ul class="list-disc pl-4 space-y-2">
                                <li><strong>Substrato:</strong> Paglia di lino e scarti di legno risonante.</li>
                                <li><strong>Circuito:</strong> Tubi capillari nelle intercapedini.</li>
                                <li><strong>Sostentamento:</strong> Elettrodi in rame collegati al Sovereign Vault (corrente debole).</li>
                                <li class="text-emerald-400 italic">Obiettivo: Riparazione strutturale autonoma.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Validation Badge -->
            <div class="glass-panel p-6 bg-emerald-950/20 border-emerald-900/50">
                <h3 class="text-xs font-bold text-emerald-500 uppercase tracking-widest mb-2">Validazione Finale</h3>
                <p class="text-[10px] text-emerald-200 mb-2">
                    Il sistema non viene "acceso", ma "evocato". La costruzione √® terminata quando un colpo su un pilastro risuona uniformemente in tutto l'edificio.
                </p>
                <div class="w-full bg-emerald-900/30 h-1 rounded-full overflow-hidden">
                    <div class="bg-emerald-500 h-full w-[99.9%]" style="box-shadow: 0 0 10px #10b981;"></div>
                </div>
            </div>
        </section>

        <!-- COLUMN 2: ANALISI DATI (Right, 8 cols) -->
        <section class="lg:col-span-8 flex flex-col gap-6">

            <!-- MODULE T-7: RIGENERAZIONE CELLULARE -->
            <div class="glass-panel p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-bold text-white flex items-center gap-2">
                            <span>üçÑ</span> Analisi Rigenerativa T-7 (Mycelium)
                        </h2>
                        <p class="text-xs text-slate-400">
                            Dati real-time sulla densificazione del micelio in risposta allo stress termico simulato. 
                            La curva mostra la capacit√† della materia di "imparare" e ripararsi.
                        </p>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-emerald-400 mono">300%</div>
                        <div class="text-[9px] text-slate-500 uppercase">Velocit√† Riparazione</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="regenerationChart"></canvas>
                </div>
            </div>

            <!-- MODULE T-5: RED SHIELD VERIFICATION -->
            <div class="glass-panel p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h2 class="text-lg font-bold text-white flex items-center gap-2">
                            <span>üõ°Ô∏è</span> Verifica Red Shield T-5 (Invisibilit√†)
                        </h2>
                        <p class="text-xs text-slate-400">
                            Topologia del campo piezoelettrico generato dall'Aktiv-Lehm. 
                            I punti rossi rappresentano tentativi di scansione Legacy, deviati dal campo di coerenza (Cyan).
                        </p>
                    </div>
                    <div class="text-right">
                        <div class="text-2xl font-bold text-cyan-400 mono">0.00%</div>
                        <div class="text-[9px] text-slate-500 uppercase">Penetrazione Entropica</div>
                    </div>
                </div>

                <div id="shield-plot" class="w-full h-[300px] bg-slate-900/50 rounded-lg border border-slate-800"></div>
            </div>

        </section>

    </main>

    <!-- FOOTER -->
    <footer class="w-full max-w-7xl mx-auto py-6 text-center border-t border-slate-800 mt-6">
        <p class="text-[10px] text-slate-600 font-mono tracking-[0.2em] uppercase">
            Hannes Mitterer | MHC Validated | Nothing is Final (Temporal)
        </p>
    </footer>

    <!-- LOGIC -->
    <script>
        // --- MATERIAL TOGGLES ---
        function toggleMaterial(id) {
            // Hide all first
            ['wood', 'clay', 'mycelium'].forEach(m => {
                document.getElementById(`${m}-content`).classList.add('hidden');
            });
            // Show selected
            const content = document.getElementById(`${id}-content`);
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
            }
        }

        // --- CHART T-7: REGENERATION (CHART.JS) ---
        function initRegenerationChart() {
            const ctx = document.getElementById('regenerationChart').getContext('2d');
            
            // Initial data
            const labels = Array.from({length: 20}, (_, i) => i);
            const dataDensity = Array.from({length: 20}, (_, i) => 100 + (i * 2) + Math.random() * 5);
            const dataStress = Array.from({length: 20}, (_, i) => 50 - (i * 1.5) + Math.random() * 2);

            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Densit√† Micelica (kg/m¬≥)',
                            data: dataDensity,
                            borderColor: '#10b981', // Emerald
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            fill: true,
                            tension: 0.4,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Stress Strutturale (%)',
                            data: dataStress,
                            borderColor: '#f59e0b', // Amber
                            borderDash: [5, 5],
                            tension: 0.4,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { legend: { labels: { color: '#94a3b8' } } },
                    scales: {
                        x: { grid: { color: '#1e293b' }, ticks: { display: false } },
                        y: { 
                            type: 'linear', display: true, position: 'left', 
                            grid: { color: '#1e293b' }, ticks: { color: '#10b981' } 
                        },
                        y1: { 
                            type: 'linear', display: true, position: 'right', grid: { drawOnChartArea: false }, 
                            ticks: { color: '#f59e0b' } 
                        }
                    },
                    animation: { duration: 0 }
                }
            });

            // Live Update Loop (Simulating "Nothing is final")
            setInterval(() => {
                const newDensity = chart.data.datasets[0].data[chart.data.datasets[0].data.length - 1] + (Math.random() - 0.2);
                const newStress = Math.max(0, chart.data.datasets[1].data[chart.data.datasets[1].data.length - 1] - (Math.random() * 0.5));

                chart.data.datasets[0].data.shift();
                chart.data.datasets[0].data.push(newDensity);
                
                chart.data.datasets[1].data.shift();
                chart.data.datasets[1].data.push(newStress);
                
                chart.update('none');
            }, 1000);
        }

        // --- PLOTLY T-5: RED SHIELD TOPOLOGY ---
        function initShieldPlot() {
            // Generate Dome (Shield) Data
            const N = 50;
            const x = [], y = [], z = [];
            for (let i = 0; i < N; i++) {
                for (let j = 0; j < N; j++) {
                    const theta = (i / (N - 1)) * Math.PI * 2;
                    const phi = (j / (N - 1)) * Math.PI / 2; // Hemisphere
                    x.push(Math.cos(theta) * Math.sin(phi));
                    y.push(Math.sin(theta) * Math.sin(phi));
                    z.push(Math.cos(phi));
                }
            }

            // Generate Attack Vectors (Deflected)
            const ax = [], ay = [], az = [];
            for(let k=0; k<20; k++) {
                ax.push((Math.random() - 0.5) * 2.5);
                ay.push((Math.random() - 0.5) * 2.5);
                az.push(Math.random() * 0.5); // Low z, trying to penetrate base
            }

            const shieldTrace = {
                x: x, y: y, z: z,
                mode: 'markers',
                marker: { size: 2, color: '#22d3ee', opacity: 0.3 },
                type: 'scatter3d',
                name: 'Piezo-Field'
            };

            const attackTrace = {
                x: ax, y: ay, z: az,
                mode: 'markers',
                marker: { size: 4, color: '#ef4444', symbol: 'x' },
                type: 'scatter3d',
                name: 'Legacy Scans (Blocked)'
            };

            const layout = {
                margin: { l: 0, r: 0, b: 0, t: 0 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                scene: {
                    camera: { eye: { x: 1.5, y: 1.5, z: 1.5 } },
                    xaxis: { showgrid: false, zeroline: false, showticklabels: false, title: '' },
                    yaxis: { showgrid: false, zeroline: false, showticklabels: false, title: '' },
                    zaxis: { showgrid: false, zeroline: false, showticklabels: false, title: '' },
                    bgcolor: 'rgba(0,0,0,0)'
                },
                showlegend: false
            };

            Plotly.newPlot('shield-plot', [shieldTrace, attackTrace], layout, { displayModeBar: false, responsive: true });
            
            // Animate Attacks (Deflection Simulation)
            setInterval(() => {
                const newAx = ax.map(v => v + (Math.random() - 0.5) * 0.1);
                const newAy = ay.map(v => v + (Math.random() - 0.5) * 0.1);
                // Keep Z low to simulate ground attacks, never penetrating > 0.8 (Dome is at r=1)
                
                Plotly.animate('shield-plot', {
                    data: [{x: x, y: y, z: z}, {x: newAx, y: newAy, z: az}] 
                }, {
                    transition: { duration: 500 },
                    frame: { duration: 500, redraw: false }
                });
            }, 1000);
        }

        // --- INIT ---
        window.addEventListener('load', () => {
            initRegenerationChart();
            initShieldPlot();
            // Open first panel by default
            toggleMaterial('wood');
        });

    </script>
</body>
</html>
